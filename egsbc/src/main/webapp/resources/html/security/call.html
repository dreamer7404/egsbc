<section id="widget-grid" class="">

	<!-- row -->
	<div class="row">

		<!-- NEW WIDGET START -->
		<article class="col-xs-12 col-sm-12 col-md-12 col-lg-12">

			<!-- Widget ID (each widget will need unique ID)-->
			<div class="jarviswidget jarviswidget-color-blueDark" id="wid-id-99" data-widget-editbutton="false">
				<header >
					<span class="widget-icon"> <i class="fa fa-table"></i> </span>
					<h2>Security Settings</h2>
				</header>
				<!-- widget div-->
				<div>
					<form class="smart-form" id="frmCallSettings" novalidate="novalidate">
					<div>
						
						<table border="0" width="100%">
<!-- 						<tr> -->
<!-- 							<td class="td-label" width="140px">GEO-IP Policy</td> -->
<!-- 							<td width="40px"> -->
<!-- 									<label id="lblGeoIp" style="font-weight:bold"></label> -->
<!-- 							</td> -->
<!-- 							<td> -->
<!-- 								<button type="button" class="btn btn-default btn-goDetail" id="btnGoGeoIp"> -->
<!-- 									<i class="fa fa-hand-o-right" ></i> -->
<!-- 									Click here for the detailed settings -->
<!-- 								</button> -->
<!-- 							</td> -->
<!-- 						</tr> -->
						<tr>
							<td class="td-label" width="140px">User-Agent Policy</td>
							<td width="40px">
								<label id="lblUserAgent" style="font-weight:bold"></label>
							</td>
							<td >
								<button type="button" class="btn btn-default btn-goDetail" id="btnGoUserAgent">
								<i class="fa fa-hand-o-right" ></i>
								Click here for the detailed settings</button>
							</td>
						</tr>
						<tr>
							<td class="td-label" >Call Pattern</td>
							<td >
								<label id="lblCallPattern" style="font-weight:bold"></label>
							</td>
							<td >
								<button type="button" class="btn btn-default btn-goDetail" id="btnGoCallPattern">
								<i class="fa fa-hand-o-right" ></i>
								Click here for the detailed settings</button>
							</td>
						</tr>
						<tr>
							<td class="td-label">Toll Fraud Policy</td>
							<td>
								<label id="lblOverseasPolicy" style="font-weight:bold"></label>
							</td>
							<td>
								<button type="button" class="btn btn-default btn-goDetail" id="btnGoOverseas">
								<i class="fa fa-hand-o-right" ></i>
								Click here for the detailed settings</button>
							</td>
						</tr>
						<tr>
							<td class="td-label">Call Gapping Policy</td>
							<td>
								<label id="lblGappingPolicy" style="font-weight:bold"></label>
							</td>
							<td>
								<button type="button" class="btn btn-default btn-goDetail" id="btnGoCallGapping">
								<i class="fa fa-hand-o-right" ></i>
								Click here for the detailed settings</button>
							</td>
						</tr>
<!-- 						<tr> -->
<!-- 							<td class="td-label">IM Signature Policy</td> -->
<!-- 							<td> -->
<!-- 								<label id="lblSignaturePolicy" style="font-weight:bold"></label> -->
<!-- 							</td> -->
<!-- 							<td> -->
<!-- 								<button type="button" class="btn btn-default btn-goDetail" id="btnGoImSignature"> -->
<!-- 								<i class="fa fa-hand-o-right" ></i> -->
<!-- 								Click here for the detailed settings</button> -->
<!-- 							</td> -->
<!-- 						</tr> -->
						<tr>
							<td class="td-label" colspan="3">
								<div class="form-group pull-right">
									<button type="button" class="btn btn-default btn-refresh" id="btnRefreshCallSettings"> Refresh</button>
								</div>
							</td>
						</tr>
						</table>
						
					</div>
					</form>
						
				</div>
			</div>
			
			<!-- ============================== GEO-IP ===================================== -->
			
			<div class="jarviswidget jarviswidget-color-blueDark" id="widGeoIp" data-widget-editbutton="false" style="display:none" >
				<header >
					<span class="widget-icon"> <i class="fa fa-table"></i> </span>
					<h2>GEO-IP Details</h2>
				</header>
				<!-- widget div-->
				<div>
					<form class="smart-form" id="frmGeoIp" novalidate="novalidate">
					<div >
						<table border="0" width="100%">
						<tr>
							<td class="td-label" width="140px">Function</td>
							<td class="td-label" >
								<span class="onoffswitch" >
										<input type="checkbox"  class="onoffswitch-checkbox" id="chkGeoIp" >
										<label class="onoffswitch-label" for="chkGeoIp"> 
											<span class="onoffswitch-inner" data-swchon-text="ON" data-swchoff-text="OFF"></span> 
											<span class="onoffswitch-switch"></span> 
										</label> 
									</span> 	
							</td>
						</tr>
						<tr>	
							<td class="td-label">Update GEO-IP DB</td>
							<td width="80px">
								<label class="select" >
									<select  id="geoIpDbUpdateTime"  name="geoIpDbUpdateTime">
										<option value="0">0</option>
										<option value="1">1</option>
										<option value="2">2</option>
										<option value="3">3</option>
										<option value="4" selected>4</option>
										<option value="5">5</option>
										<option value="6">6</option>
										<option value="7">7</option>
										<option value="8">8</option>
										<option value="9">9</option>
										<option value="10">10</option>
										<option value="11">11</option>
										<option value="12">12</option>
										<option value="13">13</option>
										<option value="14">14</option>
										<option value="15">15</option>
										<option value="16">16</option>
										<option value="17">17</option>
										<option value="18">18</option>
										<option value="19">19</option>
										<option value="20">20</option>
										<option value="21">21</option>
										<option value="22">22</option>
										<option value="23">23</option>
									</select> <i></i> 
								</label>
							</td>
							<td class="td-label" width="100px">hour everyday</td>
							<td>
								<button type="button" class="btn btn-default btn-refreshNow" id="btnRefreshNow">Refresh Now</button>
							</td>
						</tr>
						<tr>	
							<td class="td-label">Last Update DateTime</td>
							<td class="td-label" colspan="3">
								<label id="geoUpdateDate"></label>
							</td>
						</tr>	
						<tr>	
							<td class="td-label">Available Recent</td>
							<td>
								<label class="input">
									<input type="text" id="geoIpDbAvailableTerm" name="geoIpDbAvailableTerm" value="72">
								</label>
							</td>
							<td class="td-label">hours</td>
							<td>
								<button type="button" class="btn btn-default btn-testGeoIp" id="btnTestGeoIp">Test GEO-IP</button>
							</td>
						</tr>	
						</table>
					</div>
					
					<div style="margin:15px 0">
						
						<button type="button" class="btn btn-default btn-selectAll" id="btnSelectAll">Select All</button>
						<button type="button" class="btn btn-default btn-unselectAll" id="btnUnSelectAll">Unselect All</button>
						<div class="pull-right">
							<table>
							<tr>
								<td>Set all selected nations to&nbsp;</td>
								<td>
									<label class="select" >
										<select  id="geoIpNationRule"  name="geoIpNationRule">
<!-- 											<option value="" selected="" disabled="">choose...</option> -->
											<option value="0">Deny</option>
											<option value="1">Permit</option>
										</select>
									</label>
								</td>
							</tr>
							</table>
							<input type="hidden" id="geoIpArray" name="geoIpArray" >
									
						</div>
					</div>
					</form>
					
					<form class="smart-form" id="frmGeoIpList" novalidate="novalidate">
						<div class="row" id="divGeoIpList" style="height:300px;margin:0 10px 20px 10px;border:1px solid #ddd;overflow:auto">
						</div>
					</form>
					
					<table width="100%">
					<tr>
						<td>
							<div class="form-group pull-right">
							<button type="button" class="btn btn-default btn-apply" id="btnApplyGeoIp">Apply</button>
						</div>
						</td>
					</tr>
					<tr>
						<td>
							<div style="background:#d1d1d1;height:2px;width:100%;margin:15px 0"></div>
						</td>
					</tr>
					</table>
					
					
					<form class="smart-form" id="frmGeoIpExclude" novalidate="novalidate">
						<table>
						<tr>
							<td class="td-label">
								Exclude IP / Netmask
							</td>
							<td class="td-label">
								<label class="input" >
									<input type="text" id="geoExIpKey" name="geoExIpKey">
								</label>
							</td>
							<td class="td-label">
								<div class="inline-group">
									<label class="radio">
										<input type="radio" name="geoExIpMatchType" value="0" checked>
										<i></i>Partial</label>
									<label class="radio">
										<input type="radio" name="geoExIpMatchType" value="1">
										<i></i>Full</label>
								</div>	
							</td>
							<td class="td-label">
								<button type="button" class="btn btn-default btn-add" id="btnAddGeoIpExclude">Add</button>
							</td>
						</tr>
						<tr>
							<td>
							</td>
							<td class="td-label">
								<label class="select select-multiple" >
									<select multiple="" id="geoIpExcludeList" class="custom-scroll" style="width:200px;height: 200px">
									</select>
								</label>
							</td>
							<td></td>
							<td class="td-label" style="vertical-align:top">
								<button type="button" class="btn btn-default btn-delete" id="btnDeleteGeoIpExclude">Delete</button>
							</td>
						</tr>
						</table>
					
					</form>
						
				</div>
			</div>
				
				
				<!-- ============================== USER-AGENT ===================================== -->
				
			<div class="jarviswidget jarviswidget-color-blueDark" id="widUserAgent" data-widget-editbutton="false" style="display:none">
				<header >
					<span class="widget-icon"> <i class="fa fa-table"></i> </span>
					<h2>USER-AGENT Details</h2>
				</header>
				<!-- widget div-->
				<div class="div-widget" >
				
					<form class="smart-form" id="frmUserAgentPolicy" novalidate="novalidate">
						<table border="0" width="100%">
						<tr>
							<td class="td-label" width="140px">Rule</td>
							<td class="td-label" >
								<span class="onoffswitch" >
										<input type="checkbox"  class="onoffswitch-checkbox" id="chkUserAgent" >
										<label class="onoffswitch-label" for="chkUserAgent"> 
											<span class="onoffswitch-inner" data-swchon-text="ON" data-swchoff-text="OFF"></span> 
											<span class="onoffswitch-switch"></span> 
										</label> 
									</span> 	
							</td>
							<td  class="td-label">
								<div class="form-group pull-right">
									<button type="button" class="btn btn-default btn-apply" id="btnApplyUserAgentPolicy"> Apply</button>
								</div>
							</td>	
						</tr>
<!-- 						<tr> -->
<!-- 							<td class="td-label" width="120px"> -->
<!-- 								Policy  -->
<!-- 							</td> -->
<!-- 							<td class="td-label"> -->
<!-- 								<div class="inline-group"> -->
<!-- 									<label class="radio"> -->
<!-- 										<input type="radio" name="secOvUagentPolicy" value="1"> -->
<!-- 										<i></i>Deny</label> -->
<!-- 									<label class="radio"> -->
<!-- 										<input type="radio" name="secOvUagentPolicy" value="2"> -->
<!-- 										<i></i>Permit</label> -->
<!-- 								</div> -->
<!-- 							</td> -->
<!-- 							<td  class="td-label"> -->
<!-- 								<div class="form-group pull-right"> -->
<!-- 									<button type="button" class="btn btn-default btn-apply" id="btnApplyUserAgentPolicy"> Apply</button> -->
<!-- 								</div> -->
<!-- 							</td>	 -->
						</tr>
						</table>	
					</form>
					
					<div style="background:#d1d1d1;height:2px;width:100%;margin:15px 0"></div>
					 
					
					<form class="smart-form" id="frmUserAgent" novalidate="novalidate">
						<table border="0" width="100%">
						<tr>
							<td class="td-label" width="120px">
								Value 
							</td>
							<td class="td-label" width="150px">
								<label class="input">
									<input type="text" id="condVal" name="condVal" >
								</label>
							</td>	
							<td class="td-label">
								(Word Match)
							</td>
						</tr>
						<tr>
							<td class="td-label">
								Applied Message 
							</td>
							<td class="td-label" colspan="2">
								<div class="inline-group">
										<label class="checkbox"  >
											<input type="checkbox"  id="chkMessageAll"  ><i></i>ALL
										</label>
										<label class="checkbox">
											<input type="checkbox" name="message" value="1" ><i></i>REGISTER
										</label>
										<label class="checkbox">
											<input type="checkbox" name="message" value="4" ><i></i>INVITE
										</label>
										<label class="checkbox">
											<input type="checkbox" name="message" value="40" ><i></i>MESSAGE
										</label>
										<label class="checkbox">
											<input type="checkbox" name="message" value="2" ><i></i>OPTIONS
										</label>
								</div>	
							</td>
						</tr>
						<tr>
							<td class="td-label">
								Applied Header 
							</td>
							<td colspan="2">
								<table width="100%">
								<tr>
									<td class="td-label">
										<div class="inline-group">
												<label class="checkbox"  >
													<input type="checkbox"  id="chkHeaderAll"><i></i>ALL
												</label>
												<label class="checkbox">
													<input type="checkbox" name="header"  value="8" ><i></i>USER-AGENT
												</label>
												<label class="checkbox">
													<input type="checkbox"  name="header" value="1" ><i></i>FROM
												</label>
												<label class="checkbox">
													<input type="checkbox" name="header" value="2" ><i></i>TO
												</label>
												<label class="checkbox">
													<input type="checkbox" name="header" value="16" ><i></i>SUBJECT
												</label>
										</div>	
									</td>
									<td  class="td-label">
										<div class="form-group pull-right">
											<button type="button" class="btn btn-default btn-add" id="btnAddSecUserAgent"> Add</button>
										</div>
									</td>	
								</tr>
								</table>
							</td>		
						</tr>
						</table>
					</form>
						
					<table id="dtUserAgent" class="table table-striped table-bordered table-hover"> 
					<thead> 
						<tr>
							<th class="text-center">Code</th>
							<th class="text-center">Message</th>
							<th class="text-center">Header</th>
						</tr>
					</thead>
					</table>	

					<div class="form-group text-right" style="margin:15px 0">
						<button type="button" class="btn btn-default btn-delete"  id="btnDeleteSecUserAgent"> Delete</button>
						<button type="button" class="btn btn-default btn-refresh"  id="btnRefreshSecUserAgent"> Refersh</button>
					</div>
			        	
				</div>
			</div>
	
			<!-- ############### CALL PATTERN ######################################## -->
			
			<div class="jarviswidget jarviswidget-color-blueDark" id="widCallPattern" data-widget-editbutton="false" style="display:none">
				<header >
					<span class="widget-icon"> <i class="fa fa-table"></i> </span>
					<h2>Call Pattern Details</h2>
				</header>
				<!-- widget div-->
				<div class="div-widget" >
					
					<form class="smart-form" id="frmCallPattern" novalidate="novalidate">
						<table border="0" width="100%">
<!-- 						<tr> -->
<!-- 							<td class="td-label" width="200px">Rule</td> -->
<!-- 							<td class="td-label" colspan="2"> -->
<!-- 								<span class="onoffswitch" > -->
<!-- 										<input type="checkbox"  class="onoffswitch-checkbox" id="chkCallPattern" > -->
<!-- 										<label class="onoffswitch-label" for="chkCallPattern">  -->
<!-- 											<span class="onoffswitch-inner" data-swchon-text="ON" data-swchoff-text="OFF"></span>  -->
<!-- 											<span class="onoffswitch-switch"></span>  -->
<!-- 										</label>  -->
<!-- 									</span> 	 -->
<!-- 							</td> -->
<!-- 						</tr> -->
						<tr>
							<td class="td-label" style="text-align:right" width="120px">
								- Max Calls 
							</td>
							<td class="td-label" colspan="2">
								<table>
								<tr>
									<td width="100px">
										<label class="input" name="lblClass">
											<input type="text" id="limitMaxCalls" name="limitMaxCalls" >
										</label>
									</td>
									<td width="20px" style="text-align:center">/</td>
									<td width="100px">
										<label class="input" name="lblClass">
											<input type="text" id="limitDurationM" name="limitDurationM" >
										</label>
									</td>
									<td class="td-label">
										(min)
									</td>
								</tr>
								</table>
							</td>
						</tr>
<!-- 						<tr> -->
<!-- 							<td class="td-label"> -->
<!-- 								Call blocking exceeded Max calls -->
<!-- 							</td> -->
<!-- 							<td class="td-label" colspan="2" > -->
<!-- 									<span class="onoffswitch"> -->
<!-- 										<input type="checkbox"  class="onoffswitch-checkbox" id="totalEnable" > -->
<!-- 										<label class="onoffswitch-label" for="totalEnable">  -->
<!-- 											<span class="onoffswitch-inner" data-swchon-text="ON" data-swchoff-text="OFF"></span>  -->
<!-- 											<span class="onoffswitch-switch"></span>  -->
<!-- 										</label>  -->
<!-- 									</span>  -->
<!-- 							</td>	 -->
<!-- 						</tr> -->
						<tr>
							<td class="td-label" style="text-align:right">
								- Call blocking time
							</td>
							<td  colspan="2">
							
								<table border="0">
								<tr>
									<td class="td-label" width="100px">
										<label class="input" name="lblClass2">
											<input type="text" id="totalDurationM" name="totalDurationM" >
										</label>
									</td>
									<td>
										(min)
									</td>
<!-- 									<td class="td-label" > -->
<!-- 										<label class="input" name="lblClass2"> -->
<!-- 											<input type="text" id="totalDurationH" name="totalDurationH" > -->
<!-- 										</label> -->
<!-- 									</td> -->
<!-- 									<td> -->
<!-- 										(hour) -->
<!-- 									</td> -->
									<td></td>
								</tr>
								</table>
							</td>
						</tr>	
						</table>

						<div class="form-group text-right" style="margin:15px 0">
				          	<button type="button" class="btn btn-default btn-apply"  id="btnApplyCallPattern"> Apply</button>
			        	</div>
			        	
			        </form>
			        	
				</div>
			</div>
				
			<!-- ############### Toll Fraud ######################################## -->
			
				<!-- Widget ID (each widget will need unique ID)-->
			<div class="jarviswidget jarviswidget-color-blueDark" id="widOverseas" data-widget-editbutton="false" style="display:none">
				<header >
					<span class="widget-icon"> <i class="fa fa-table"></i> </span>
					<h2>Toll Fraud Details</h2>
				</header>
				<!-- widget div-->
				<div class="div-widget" >
				
					<form class="smart-form" id="frmOverseasPolicy" novalidate="novalidate">
						<table border="0" width="100%">
						<tr>
							<td class="td-label" width="120px">Rule</td>
							<td class="td-label" >
								<span class="onoffswitch" >
										<input type="checkbox"  class="onoffswitch-checkbox" id="chkOverseas">
										<label class="onoffswitch-label" for="chkOverseas"> 
											<span class="onoffswitch-inner" data-swchon-text="ON" data-swchoff-text="OFF"></span> 
											<span class="onoffswitch-switch"></span> 
										</label> 
									</span> 	
							</td>
						</tr>
						<tr>
							<td class="td-label" width="120px">
								Policy 
							</td>
							<td class="td-label">
								<div class="inline-group">
									<label class="radio">
										<input type="radio" name="secOvCallOverseasPolicy" value="1">
										<i></i>Deny</label>
									<label class="radio">
										<input type="radio" name="secOvCallOverseasPolicy" value="2">
										<i></i>Permit</label>
								</div>
							</td>
							<td  class="td-label">
								<div class="form-group pull-right">
									<button type="button" class="btn btn-default btn-apply" id="btnApplyOverseasPolicy"> Apply</button>
								</div>
							</td>	
						</tr>
						</table>	
					</form>
					
					<div style="background:#d1d1d1;height:2px;width:100%;margin:15px 0"></div>
					 
					
					<form class="smart-form" id="frmOverseas" novalidate="novalidate">
						<table border="0" width="100%">
						<tr>
							<td class="td-label" width="120px">
								International Number
							</td>
							<td class="td-label" width="200px">
								<label class="input">
									<input type="text" id="condVal" name="condVal" >
								</label>
							</td>	
							<td class="td-label">
								(Prefix Match)
							</td>
						</tr>
						<tr>
							<td class="td-label">
								Action 
							</td>
							<td class="td-label" >
								<div class="inline-group">
									<label class="radio">
										<input type="radio" name="policyMode" value="2" checked>
										<i></i>Alert only</label>
									<label class="radio">
										<input type="radio" name="policyMode" value="1">
										<i></i>Block</label>
<!-- 									<label class="radio"> -->
<!-- 										<input type="radio" name="policyMode" value="3"> -->
<!-- 										<i></i>Block Based on limit setting</label>	 -->
								</div>	
							</td>
							<td  class="td-label">
								<div class="form-group pull-right">
									<button type="button" class="btn btn-default btn-add" id="btnAddOverseas"> Add</button>
								</div>
							</td>	
						</tr>
						<tr>
							<td class="td-label" style="vertical-align:top">
								International Number
							</td>
							<td class="td-label">
								<label class="select select-multiple" >
									<select multiple="" id="selOverseas" class="custom-scroll" style="width:200px;height:150px">
									</select>
								</label>
							</td>
							<td class="td-label" style="vertical-align:top" >
								<button type="button" class="btn btn-default btn-delete"  id="btnDeleteOverseas"> Delete</button>
							</td>
						</tr>
						</table>
					</form>
						
					
					<!-- ========================= oversease user ===================================== -->
<!-- 					<div style="background:#d1d1d1;height:2px;width:100%;margin:15px 0"></div> -->
						
					<div style="width:100%;border-bottom:1px solid #d1d1d1;margin:20px 0;">
		        		<strong>Excluded Caller from Deny Policy</strong>
		        	</div>
					
					<form class="smart-form" id="frmOverseasUser" novalidate="novalidate">
						<table border="0" width="100%">
						<tr>
							<td class="td-label" width="120px">
								Phone Number
							</td>
							<td class="td-label" width="150px">
								<label class="input">
									<input type="text" id="condVal" name="condVal" >
								</label>
							</td>	
							<td class="td-label">
								(Regular Expression possible)
							</td>
						</tr>
						<tr>
							<td class="td-label" style="vertical-align:top" >
								Phone Number
							</td>
							<td class="td-label">
								<label class="select select-multiple" >
									<select multiple="" id="selOverseasUser" class="custom-scroll" style="width:200px;height:150px">
									</select>
								</label>
							</td>
							<td class="td-label" style="vertical-align:top" >
								<button type="button" class="btn btn-default btn-delete"  id="btnDeleteOverseasUser">Delete</button>
							</td>
						</tr>
						</table>
					</form>
						
			        	
				</div>
			</div>
			
			<!-- ############### CALL GAPPING######################################## -->
			
				<!-- Widget ID (each widget will need unique ID)-->
			<div class="jarviswidget jarviswidget-color-blueDark" id="widCallGapping" data-widget-editbutton="false" style="display:none">
				<header >
					<span class="widget-icon"> <i class="fa fa-table"></i> </span>
					<h2>Call Gapping Details</h2>
				</header>
				<!-- widget div-->
				<div class="div-widget" >
					
					<form class="smart-form" id="frmCallGappingMode" novalidate="novalidate">
						<table border="0" width="100%">
						<tr>
							<td class="td-label" width="120px">Rule</td>
							<td class="td-label" >
								<span class="onoffswitch" >
										<input type="checkbox"  class="onoffswitch-checkbox" id="chkCallGapping">
										<label class="onoffswitch-label" for="chkCallGapping"> 
											<span class="onoffswitch-inner" data-swchon-text="ON" data-swchoff-text="OFF"></span> 
											<span class="onoffswitch-switch"></span> 
										</label> 
									</span> 	
							</td>
							<td  class="td-label">
								<div class="form-group pull-right">
									<button type="button" class="btn btn-default btn-add" id="btnApplyCallGapping"> Apply</button>
								</div>
							</td>	
						</tr>
						</table>
					</form>	
						
						<div style="background:#d1d1d1;height:2px;width:100%;margin:15px 0"></div>
						
					<form class="smart-form" id="frmCallGapping" novalidate="novalidate">	
						<table border="0" width="100%">
						<tr>
							<td class="td-label" width="120px">
								Phone Number 
							</td>
							<td class="td-label" width="150px">
								<label class="input">
									<input type="text" id="condVal" name="condVal" >
								</label>
							</td>	
							<td class="td-label">
								(Prefix Match)
							</td>
						</tr>
						<tr>
							<td class="td-label">
								Max Calls
							</td>
							<td colspan="2">
								<table width="100%">
								<tr>
									<td class="td-label">
										<table>
										<tr>
											<td width="150px">
												<label class="input" name="lblClass">
													<input type="text" id="limitMaxCalls" name="limitMaxCalls" >
												</label>
											</td>
											<td width="20px" style="text-align:center"">/</td>
											<td width="60px" >
												<label class="input" name="lblClass">
													<input type="text" id="limitDurationS" name="limitDurationS" >
												</label>
											</td>
											<td class="td-label">
												(min)
											</td>
										</tr>
										</table>
									</td>
									<td  class="td-label">
										<div class="form-group pull-right">
											<button type="button" class="btn btn-default btn-add" id="btnAddCallGapping"> Add</button>
										</div>
									</td>	
								</tr>
								</table>
							</td>
						</tr>
						</table>
					</form>
						
					<table id="dtCallGapping" class="table table-striped table-bordered table-hover"> 
					<thead> 
						<tr>
							<th class="text-center">Phone Number</th>
							<th class="text-center">Max Call </th>
						</tr>
					</thead>
					</table>	

					<div class="form-group text-right" style="margin:15px 0">
						<button type="button" class="btn btn-default btn-delete"  id="btnDeleteCallGapping"> Delete</button>
						<button type="button" class="btn btn-default btn-refresh" id="btnRefreshCallGapping"> Refresh</button>
					</div>
			        	
				</div>
			</div>
				
			
			<!-- ############### IM Signature  ######################################## -->
			
<!-- 			<div class="jarviswidget jarviswidget-color-blueDark" id="widImSignature" data-widget-editbutton="false" style="display:none"> -->
<!-- 				<header > -->
<!-- 					<span class="widget-icon"> <i class="fa fa-table"></i> </span> -->
<!-- 					<h2>IM Signature Details</h2> -->
<!-- 				</header> -->
<!-- 				widget div -->
<!-- 				<div class="div-widget"> -->
					
<!-- 					<form class="smart-form" id="frmImSignature" novalidate="novalidate"> -->
<!-- 						<table border="0" width="100%"> -->
<!-- 						<tr> -->
<!-- 							<td class="td-label" width="120px">Rule</td> -->
<!-- 							<td class="td-label" > -->
<!-- 								<span class="onoffswitch" > -->
<!-- 										<input type="checkbox"  class="onoffswitch-checkbox" id="chkImSignature"> -->
<!-- 										<label class="onoffswitch-label" for="chkImSignature">  -->
<!-- 											<span class="onoffswitch-inner" data-swchon-text="ON" data-swchoff-text="OFF"></span>  -->
<!-- 											<span class="onoffswitch-switch"></span>  -->
<!-- 										</label>  -->
<!-- 									</span> 	 -->
<!-- 							</td> -->
<!-- 							<td></td> -->
<!-- 						</tr>	 -->
<!-- 						<tr> -->
<!-- 							<td class="td-label"> -->
<!-- 								Applied Header  -->
<!-- 							</td> -->
<!-- 							<td colspan="2"> -->
<!-- 								<table width="100%"> -->
<!-- 								<tr> -->
<!-- 									<td class="td-label"> -->
<!-- 										<div class="inline-group"> -->
<!-- 												<label class="checkbox"  > -->
<!-- 													<input type="checkbox"  id="chkHeaderAll"><i></i>ALL -->
<!-- 												</label> -->
<!-- 												<label class="checkbox"> -->
<!-- 													<input type="checkbox" name="header"  value="8" ><i></i>USER-AGENT -->
<!-- 												</label> -->
<!-- 												<label class="checkbox"> -->
<!-- 													<input type="checkbox"  name="header" value="1" ><i></i>FROM -->
<!-- 												</label> -->
<!-- 												<label class="checkbox"> -->
<!-- 													<input type="checkbox" name="header" value="2" ><i></i>TO -->
<!-- 												</label> -->
<!-- 												<label class="checkbox"> -->
<!-- 													<input type="checkbox" name="header" value="16" ><i></i>SUBJECT -->
<!-- 												</label> -->
<!-- 										</div>	 -->
<!-- 									</td> -->
<!-- 									<td  class="td-label"> -->
<!-- 										<div class="form-group pull-right"> -->
<!-- 											<button type="button" class="btn btn-default btn-apply" id="btnApplyImSignature"> Apply</button> -->
<!-- 										</div> -->
<!-- 									</td>	 -->
<!-- 								</tr> -->
<!-- 								</table> -->
<!-- 							</td>		 -->
<!-- 						</tr> -->
<!-- 						</table> -->
<!-- 					</form> -->
					
					
<!-- 					========================= IM Signature VAL ===================================== -->
<!-- 			        <div style="background:#d1d1d1;height:2px;width:100%;margin:15px 0"></div> -->
			        	
<!-- 			        <form class="smart-form" id="frmSignatureRegister" novalidate="novalidate"> -->
<!-- 						<table border="0" width="100%"> -->
<!-- 						<tr> -->
<!-- 							<td class="td-label" width="120px"> -->
<!-- 								Signature -->
<!-- 							</td> -->
<!-- 							<td colspan="2"> -->
<!-- 								<table width="100%" border="0"> -->
<!-- 								<tr> -->
<!-- 									<td class="td-label" width="120px"> -->
<!-- 										<label class="input"> -->
<!-- 											<input type="text" id="condVal" name="condVal" > -->
<!-- 										</label> -->
<!-- 									</td> -->
<!-- 									<td class="td-label"> -->
<!-- 										(Regular Expression possible) -->
<!-- 									</td> -->
<!-- 									<td  class="td-label"> -->
<!-- 										<div class="form-group pull-right"> -->
<!-- 											<button type="button" class="btn btn-default btn-apply" id="btnAddSignatureRegister"> Add</button> -->
<!-- 										</div> -->
<!-- 									</td>	 -->
<!-- 								</tr> -->
<!-- 								</table> -->
<!-- 							</td>		 -->
<!-- 						</tr> -->
<!-- 						<tr> -->
<!-- 							<td class="td-label" width="120px"> -->
<!-- 							</td> -->
<!-- 							<td class="td-label" width="210px"> -->
<!-- 									<label class="select select-multiple" > -->
<!-- 										<select multiple="" id="selImSignatureVal" class="custom-scroll" style="width:200px;height:150px"> -->
<!-- 									</select> -->
<!-- 								</label> -->
<!-- 							</td> -->
<!-- 							<td class="td-label" style="vertical-align:top;text-align:left"> -->
<!-- 								<button type="button" class="btn btn-default btn-delete" id="btnDeleteImSignatureVal">Delete</button> -->
<!-- 							</td>	 -->
<!-- 						</tr>	 -->
<!-- 						</table> -->
<!-- 					</form>	 -->
					
<!-- 					<br /> -->
			        	
<!-- 				</div>			 -->
<!-- 			</div>	 -->
			
			
			<!-- bottom space -->
			<div style="height:1px;margin-bottom:40px"></div>
						
		</article>
	</div>
</section>



<!-- Modal modalGeoIp -->
  <div class="modal " id="modalGeoIp" role="dialog">
    <div class="modal-dialog modal-vertical-centered"  style="width:500px">
      	<div class="modal-content">
	        <div class="modal-header " style="height:40px;padding-top:10px;">
	          <div class="modal-title">Test GEO-IP</div>
	        </div>
        	<div class="modal-body" style="height:500px">
          
					<div class="row">
					
						<form class="smart-form" id="frmGeoIpDialog"  novalidate="novalidate">
							<table width="100%" border="0" style="margin:0 auto;">
							<tr>
								<td class="td-label" colspan="3">
									<label><i class="fa fa-caret-right"></i> Lookup nation by IP Address</label>
								</td>
							</tr>
							<tr>
								<td class="td-label" width="100px">IP Address</td>
								<td>
									<label class="input">
										<input type='text'  id="ip" name="ip">
									</label>
								</td>
								<td style="padding-left:10px">
									<button type="button" class="btn btn-default btn-test" id="btnTest">Test</button>
								</td>
							</tr>
							<tr >
								<td class="td-label"></td>
								<td colspan="2">
									<label id="nation" style="font-weight:bold"></label>
								</td>
							</tr>
							<tr>
								<td class="td-label" colspan="3">
									<label><i class="fa fa-caret-right"></i> Search IP Address by nation</label>
								</td>
							</tr>
							<tr>
								<td class="td-label">Nation</td>
								<td>
									<label class="select" >
										<select  id="geoIp" class="form-control" >
										</select>
									</label>
								</td>
								<td style="padding-left:10px">
									<button type="button" class="btn btn-default btn-search" id="btnSearch">Search</button>
								</td>
							</tr>
							</table>
						</form>
					</div>
					<div id="divGeoIpResult" style="margin:13px 0;border:1px solid #ddd;overflow:auto;height:260px"></div>
			</div>
			<div class="modal-footer" style="height:50px;padding:10px 20px 0 0;">
	          	<button type="button" class="btn btn-default" data-dismiss="modal" >Close</button>
        	</div>
		</div>
	</div>
</div>	

<script type="text/javascript">
var tableGeoIp, tableUserAgent, tableOverseas, tableOverseasUser, tableCallGapping;
var validatorGeoIpExclude, validatorUserAgent, validatorCallPattern, validatorOverseas, validatorOverseasUser, validatorCallGapping, validatorSignatureRegister;

var pagefunction = function() {
	
	
	//========================= security settings ===========================================
	// apply policy
	$("#frmCallSettings #btnApplyCallSettings").click(function(){
		showConfirm('Confirm', "Do you really want to apply?");
		$("#btnConfirm").unbind('click');
		$("#btnConfirm").click(function(){
	 		showLoader();
	 		applyOverview();
		});	
	});
	
	// refresh
	$("#frmCallSettings #btnRefreshCallSettings").click(function(){
		getSecOverview();
	});
	
	
	// init
	setTimeout(function(){
		
		//settings
		getSecOverview();
		
		//GEO-IP
		getGeoIpConfig();
		getGeoIpList();	
		
		// call pattern
		getCallPattern();
// 		toggleLimitEnable();
		
		// overseas
		getOverseas();
		toogleOverseasLimit();
		
		// overseasUser
		getOverseasUser();
		
		// Im signature
// 		getSecImSignatureHdr();
// 		getSecImSignatureVal();
		
		// showDetail
		showDetail(null);
	},1000);
	
	
	//========================= GEO-IP Settings ===========================================
	
	// Set all selected nations to
	$.post("getPrimitiveConfig", {argString: "GEO_IP_ACTION_RULE"}, function(json){
		if(json.data==null || json.data==1){ // permit
			$("#frmGeoIp #geoIpNationRule").val(1);
		}else{ // deny
			$("#frmGeoIp #geoIpNationRule").val(0);
		}
	});
	
	// select all 
	$("#frmGeoIp #btnSelectAll").click(function(){ 
		$("#frmGeoIpList input[type=checkbox]").prop("checked", true);
	});
	
	$("#frmGeoIp #btnUnSelectAll").click(function(){ 
		$("#frmGeoIpList input[type=checkbox]").prop("checked", false);
	});
	
	// apply geo-ip
	$("#btnApplyGeoIp").click(function(){ 
		// get nation rule
		var rule = getControlSelect("frmGeoIp", "geoIpNationRule");
		if(rule == null){
			showMsg("Warning", "Select nations!");
			return;
		}
		// get checkbox all value
		var str='';
		$("#frmGeoIpList input[type=checkbox]").each(function(){
			//if(this.checked){
				if(str!='') str +='@';
				str+=this.id +'|'+rule;
			//}
		});
		// set geoIp
		$("#geoIpArray").val(str);
	
		//if($("#frmGeoIp").valid()){
			
			showConfirm('Confirm', "Do you want to apply?");
			
			$("#btnConfirm").unbind('click');
			$("#btnConfirm").click(function(){
				showLoader();
				$("#frmGeoIp").submit();
			});
		//}
	});
	
	$("#frmGeoIp").ajaxForm({
		url: "/takeGeoIp",
		type: "POST",
		beforeSubmit: function(arr, $form, options){ 
			var mode = getMode();
			arr.push({name:'secOvGeoIpMode', value: mode.secOvGeoIpMode}); 
			arr.push({name:'secOvUagentMode', value: mode.secOvUagentMode}); 
			arr.push({name:'secOvCallPatternMode', value: mode.secOvCallPatternMode}); 
			arr.push({name:'secOvCallOverseasMode', value: mode.secOvCallOverseasMode}); 
			arr.push({name:'secOvCallGappingMode', value: mode.secOvCallGappingMode}); 
			arr.push({name:'secOvImSignatureMode', value: mode.secOvImSignatureMode}); 
			
			arr.push({name:'opMode', value: 5});  // 적용
		},
		success: function(responseText, statusText, xhr, $form){
			processResult(responseText.result, null, null, null);
		}
	});
	
	
	// Refresh Now 
	$("#frmGeoIp #btnRefreshNow").click(function(){ 
		showConfirm("Confirm", "Do you want to refresh now?");
		
		$("#btnConfirm").unbind('click');
		$("#btnConfirm").click(function(){
			showLoader();
			var param = {};
			param.opMode=8; // 8: 실행모드
			$.ajax({
				url: '/takeGeoIp',
			    type: "post",
			    data: param,
			    success: function(json) {
			    	processResult(json.result, null, null, null);
			    }
			});
		});
	});
	
	// get geoIpExcludeList 
	$.post("getSecGeoExcludeList", {}, function(json){
		
		var list = json.result;
		
		var obj=$("#frmGeoIpExclude #geoIpExcludeList");
		obj.empty();
		for(var i=0; i<list.length; i++){
			var item = list[i];
			var type = (item.geoExIpMatchType==0)?"P":"F";
			obj.append("<option value='"+item.geoExIpKey+"|"+item.geoExIpMatchType+"'>"+item.geoExIpKey+" (" + type + ")</option>");
		}
	});
	
	// Add GeoIpExclude
	$("#frmGeoIpExclude #btnAddGeoIpExclude").click(function(){
		
		if(!$('#frmGeoIpExclude').valid()){
			return;
		}
		
		var geoExIpKey = getControlInput("frmGeoIpExclude", "geoExIpKey");
		var geoExIpMatchType = getControlRadio("frmGeoIpExclude", "geoExIpMatchType");

		showConfirm('Confirm', "Do you want to add?");
		$("#btnConfirm").unbind('click');
		$("#btnConfirm").click(function(){
			showLoader();
			var param = {geoExIpKey: geoExIpKey , geoExIpMatchType: geoExIpMatchType};
			param.opMode=2; // add 
			$.ajax({
				url: '/takeGeoIpExclude',
			    type: "post",
			    data: param,
			    success: function(json) {
			    	processResult(json.result, null, null, null);
			    }
			});
		});
		
	});
	
	validatorGeoIpExclude = $('#frmGeoIpExclude').validate({
// 		onfocusout: function(element) {$(element).valid()},
// 		onkeyup: function(element) {$(element).valid();},
		rules : {
			geoExIpKey:{
				required : true,
				//pattern: /^[\d\.*]+$/
				IP4Checker: true
			}
		},
		messages : {
			geoExIpKey:{
				required: 'Input exclude IP',
				IP4Checker: 'Input proper exclude IP'
			}
		},
		errorPlacement : function(error, element) {
			error.insertAfter(element.parent());
		}
	});
	
	// Delete  GeoIpExclude
	$("#frmGeoIpExclude #btnDeleteGeoIpExclude").click(function(){
		var obj=$("#frmGeoIpExclude #geoIpExcludeList");
		if(obj.val()!=null){
			var ip=obj.val();
			
			// 한개만 선택하게.
			if(ip.length>1){
				showMsg("Warning", "Select one IP.");
				return;
			}
			
			var arr = ip[0].split("|");
			
			showConfirm("Confirm", "Do you want to delete?");
			
			$("#btnConfirm").unbind('click');
			$("#btnConfirm").click(function(){
				showLoader();
				var param = {geoExIpKey: arr[0], geoExIpMatchType: arr[1]};
				param.opMode=4; // remove opMode
				$.ajax({
					url: '/takeGeoIpExclude',
				    type: "post",
				    data: param,
				    success: function(json) {
				    	processResult(json.result, null, null, null);
				    }
				});
			});
			
		}
		
	});
		
	
	//-------------------------------------------- dailog ---------------------------------------------------------------
	
	// Open dialog - Test GEO-IP
	$("#frmGeoIp #btnTestGeoIp").click(function(){ 
		$("#frmGeoIp #geoIp").empty();
		
		$.post("getGeoIpList", {}, function(json){
			var list = json.result;
			
			$("#frmGeoIpDialog #geoIp").append('<option value="" selected="" disabled="">choose nation...</option>');
			for(var i=0;i<list.length;i++){
				var item = list[i];
				$("#frmGeoIpDialog #geoIp").append('<option value="'+item.abbr+'">'+item.name+'</option>');
			}
			showModal($("#modalGeoIp"));
		});
		
		// clear
		$("#nation").html('');
		validatorIp.resetForm();
	});
	
	
	// test lookup
	$("#frmGeoIpDialog #btnTest").click(function(){
		$("#nation").html('');
		var ip=$("#frmGeoIpDialog #ip").val();
 		if($('#frmGeoIpDialog').valid()){
 			$.post("testLookup", {ip:ip}, function(json){
 				$("#nation").html(json.result);
 			});
 		}
	});
	
	validatorIp = $('#frmGeoIpDialog').validate({
// 		onfocusout: function(element) {$(element).valid()},
// 		onkeyup: function(element) {$(element).valid();},
		rules : {
			ip : {
				required: true, 
				IP4Checker:true
			}
		},
		messages : {
			ip : {
				required : 'Input IP address',
			}
		},
		errorPlacement : function(error, element) {
			error.insertAfter(element.parent());
		},
	});
	
	$.validator.addMethod('IP4Checker', function(value) {
        var ip = "^(([0-9]|[1-9][0-9]|1[0-9]{2}|2[0-4][0-9]|25[0-5])\.){3}([0-9]|[1-9][0-9]|1[0-9]{2}|2[0-4][0-9]|25[0-5])$";
            return value.match(ip);
	}, 'Invalid IP address');
	
	
	
	// search
	$("#frmGeoIpDialog #btnSearch").click(function(){
		var nationCode = $("#frmGeoIpDialog #geoIp").val();
		if(nationCode==null){
			ShowMsg("Warning", "Select nation.");
			return;
		}
		
		var w=$("#divGeoIpResult").width();
		var h=$("#divGeoIpResult").height();
		
		$("#divGeoIpResult").html('<div class="middle" style="width:'+w+'px;height:'+h+'px;text-align:center;font-weight:bold">Loading...</div>');
		
		
		$.post("getNationCodeList",{nationCode: nationCode}, function(json){
			
			var html=
				"<table width='100%'>"+
				"<tr>"+
					"<td align='left' style='padding-left:5px;color:#415555;background-color:#f1f1f1'>No</td>"+
					"<td align='left' style='padding-left:5px;color:#415555;background-color:#f1f1f1'>GEO-IP</td>"+
					"<td align='left' style='padding-left:5px;color:#415555;background-color:#f1f1f1'>Update Date</td>"+
				"</tr>";	
			
			var list=json.result;
			for(var i=0; i<list.length; i++){
				var item=list[i];
				html += 
// 					"<tr style='border-bottom:1pt solid #efefef'>"+
// 						"<td style='padding-left:5px'>"+(i+1)+"</td>"+
// 						"<td style='padding-left:5px'>"+item.geoIp+"</td>"+
// 						"<td style='padding-left:5px'>"+item.geoUpdateDate+"</td>"+
// 					"</tr>";
					"<tr class='tr-underline'>"+
						"<td>"+(i+1)+"</td>"+
						"<td>"+item.geoIp+"</td>"+
						"<td>"+item.geoUpdateDate+"</td>"+
					"</tr>";
				
			}
			html += "</table>";
			
			$("#divGeoIpResult").html(html);
			
		});
		
	});
	
	//========================= USER-AGENT ===========================================
		
		
	// apply policy
	$("#frmUserAgentPolicy #btnApplyUserAgentPolicy").click(function(){
		showConfirm('Confirm', "Do you really want to apply?");
		$("#btnConfirm").unbind('click');
		$("#btnConfirm").click(function(){
	 		showLoader();
	 		applyOverview();
		});	
	});
	
	


	
	// checkAll Message	
	$("#frmUserAgent #chkMessageAll").click(function(){
		var checked=$(this).is(":checked");
		$("#frmUserAgent input[name='message']:checkbox").each(function(){
			$(this).prop("checked", checked?true:false);
		});
	});
	
	// checkAll Header	
	$("#frmUserAgent #chkHeaderAll").click(function(){
		var checked=$(this).is(":checked");
		$("#frmUserAgent input[name='header']:checkbox").each(function(){
			$(this).prop("checked", checked?true:false);
		});
	});
	
	
	// tableCertification
	tableUserAgent = $('#dtUserAgent').DataTable({
		"sDom":  sDomNoControl,
		"oLanguage": oLanguage,
		"autoWidth" : true,
		"tableTools":tableTools,
		"scrollY" : "400px",
		"scrollX" : false,
		"scrollCollapse": true,
		"paging": false,
		"processing": true,
	 	"ajax": {
        	"url": "/getSecUserAgent",
        	"type": "post",
	  	},
        "columns": [
					{ "data": "condVal"},    // 값
					{ "data": "condMethod"},  // 메시지    
					{ "data": "condHeader"},   // 헤더   
    		    ],
    	'columnDefs': [	 
				{'targets': 0, 'className': 'text-center'},
				{'targets': 1, 'className': 'text-center', 'render': function (data, type, full, meta){ return getMethod(data); }},  
				{'targets': 2, 'className': 'text-center', 'render': function (data, type, full, meta){ return getHeader(data); }},  
    	 ]
	});	
	//	click row
	tableUserAgent.on( 'click', 'tr', function () {
		tableUserAgent.$('tr.selected').removeClass('selected');
		$(this).addClass('selected');
	});	
	
	// add SecUserAgent
	$("#frmUserAgent #btnAddSecUserAgent").click(function(){
		
		if(!$('#frmUserAgent').valid()){
			return;	
		}
		
		

		var condVal=$("#frmUserAgent #condVal").val();
		var policyMode=getControlRadio("frmUserAgent", "policy");
		
		// get condMethod
		var condMethod=0
		$("#frmUserAgent input[name='message']:checkbox").each(function(){
			if($(this).is(":checked")){
				condMethod+=parseInt($(this).val(), 10); 
			}
		});
		
		// get condHeader
		var condHeader=0
		$("#frmUserAgent input[name='header']:checkbox").each(function(){
			if($(this).is(":checked")){
				condHeader+=parseInt($(this).val(), 10); 
			}
		});
		
		if(condMethod == 0 || condHeader==0){
			showMsg("Warning", "Message and Header need options, Check please.");
			return;
		}

		showConfirm('Confirm', "Do you want to add [" + condVal + "] ?");
		$("#btnConfirm").unbind('click');
		$("#btnConfirm").click(function(){
			showLoader();
			var param = {policyMode: policyMode , condVal: condVal, condMethod:condMethod, condHeader: condHeader};
			param.opMode=2; // add 
			$.ajax({
				url: '/takeSecUserAgent',
			    type: "post",
			    data: param,
			    success: function(json) {
			    	processResult(json.result, null, tableUserAgent, null);
			    	refreshUserAgent();
			    }
			});
		});
	});	
	
	validatorUserAgent = $('#frmUserAgent').validate({
		rules : {
			condVal:{
				required : true,
			}
		},
		messages : {
			condVal:{
				required: 'Input country code',
			}
		},
		errorPlacement : function(error, element) {
			error.insertAfter(element.parent());
		}
	});
	
	
	// delete 
	$("#btnDeleteSecUserAgent").click(function(){
		var data = tableUserAgent.rows('.selected').data();
		if(data.length==0){
			showMsg("Warning", "Select a row to delete!");
		}else{
			showConfirm('Confirm', "Do you want to delete?");
			$("#btnConfirm").unbind('click');
			$("#btnConfirm").click(function(){
				showLoader();
				var param = data[0];
				param.opMode=4; // remove opMode
				$.ajax({
					url: '/takeSecUserAgent',
				    type: "post",
				    data: param,
				    success: function(json) {
				    	processResult(json.result, null, tableUserAgent, null);
				    }
				});
			});
		}
	});
	
	
	// refresh 
	$("#btnRefreshSecUserAgent").click(function(){
		tableUserAgent.ajax.reload(null, false);
	});
	
	
	//========================= CALL PATTERN ===========================================
		
// 	$("#frmCallPattern #limitEnable").click(function(){	
// 		toggleLimitEnable();
// 	});
	
// 	$("#frmCallPattern #totalEnable").click(function(){	
// 		toggleTotalEnable($(this).is(":checked"));
// 	});
		
	// call pattern apply
	$("#frmCallPattern #btnApplyCallPattern").click(function(){
		
		if(!$('#frmCallPattern').valid()){
			return;	
		}
		
// 		var limitEnable = getControlCheck("frmCallPattern", "limitEnable")?1:0;
		
		var limitMaxCalls = getControlInput("frmCallPattern", "limitMaxCalls");
		if(limitMaxCalls=='') limitMaxCalls = 0;
		
		var limitDurationM =  getControlInput("frmCallPattern", "limitDurationM");
		if(limitDurationM=='') limitDurationM = 0;
		
		
// 		var totalEnable = getControlCheck("frmCallPattern", "totalEnable")?1:0;
		
		var totalDurationM = getControlInput("frmCallPattern", "totalDurationM");
		if(totalDurationM=='') totalDurationM = 0;
		
// 		var totalDurationH = getControlInput("frmCallPattern", "totalDurationH");
// 		if(totalDurationH=='') totalDurationH = 0;
		
		showConfirm('Confirm', "Do you want to apply?");
		$("#btnConfirm").unbind('click');
		$("#btnConfirm").click(function(){
			showLoader();
			var param = {
					limitEnable: 1, 
					limitMaxCalls: limitMaxCalls, 
					limitDurationM: limitDurationM, 
// 					totalEnable: totalEnable,
					totalDurationM: totalDurationM 
// 					totalDurationH: totalDurationH
			};
			param.opMode=5; // apply 
			
			var mode = getMode();
			param.secOvGeoIpMode = mode.secOvGeoIpMode;
			param.secOvUagentMode = mode.secOvUagentMode;
			param.secOvCallPatternMode = mode.secOvCallPatternMode;
			param.secOvCallGappingMode = mode.secOvCallGappingMode;
			param.secOvImSignatureMode = mode.secOvImSignatureMode;
			
			$.ajax({
				url: '/takeSecCallPattern',
			    type: "post",
			    data: param,
			    success: function(json) {
			    	processResult(json.result, null, null, null);
			    }
			});
		});
	});
	
	validatorCallPattern = $('#frmCallPattern').validate({
		onfocusout: function(element) {$(element).valid()},
		onkeyup: function(element) {$(element).valid();},
		rules : {
			limitMaxCalls:{ 
				pattern: /^[0-9]*$/
			},
			limitDurationM:{
				pattern: /^[0-9]*$/
			},
			totalDurationM:{
				pattern: /^[0-9]*$/
			},
// 			totalDurationH:{
// 				pattern: /^[0-9]*$/
// 			}
		},
		messages : {
			limitMaxCalls:{ 
				pattern: "Input numeric"
			},
			limitDurationM:{
				pattern: "Input numeric"
			},
			totalDurationM:{
				pattern: "Input numeric"
			},
// 			totalDurationH:{
// 				pattern: "Input numeric"
// 			}
		},
		errorPlacement : function(error, element) {
			error.insertAfter(element.parent());
		}
	});
		
	
	// ############### OVERSEAS ######################################## -->
	
	// apply policy
	$("#frmOverseasPolicy #btnApplyOverseasPolicy").click(function(){
		showConfirm('Confirm', "Do you really want to apply?");
		$("#btnConfirm").unbind('click');
		$("#btnConfirm").click(function(){
	 		showLoader();
	 		applyOverview();
		});	
	});
	
	
	// 임계치차단
	findControlRadio("frmOverseas", "policyMode").click(function(){
		toogleOverseasLimit();
	});
	
	
	// add overseas
	$("#frmOverseas #btnAddOverseas").click(function(){
		if(!$('#frmOverseas').valid()){
			return;
		}
		
		var condVal = getControlInput("frmOverseas", "condVal");
		var policyMode = getControlRadio("frmOverseas", "policyMode");
		var limitMaxCalls = 0
		var limitDurationS = 0;
		if(policyMode==3){
			limitMaxCalls = getControlInput("frmOverseas", "limitMaxCalls");
			limitDurationS = getControlInput("frmOverseas", "limitDurationS");
		}
		
		showConfirm('Confirm', "Do you want to add?");
		$("#btnConfirm").unbind('click');
		$("#btnConfirm").click(function(){
			showLoader();
			var param = {condVal: condVal , policyMode: policyMode, limitMaxCalls: limitMaxCalls, limitDurationS: limitDurationS};
			param.opMode=2; // add 
			$.ajax({
				url: '/takeSecCallOverseas',
			    type: "post",
			    data: param,
			    success: function(json) {
			    	processResult(json.result, null, tableOverseas, null);
			    	refreshOverseas();
			    }
			});
		});
		
		
	});
	
	
	validatorOverseas = $('#frmOverseas').validate({
		onfocusout: function(element) {$(element).valid()},
		onkeyup: function(element) {$(element).valid();},
		rules : {
			condVal:{
				required : true,
				pattern: /^[\d\.*]+$/
			},
			limitMaxCalls:{
				pattern: /^[0-9]*$/
			},
			limitDurationS:{
				pattern: /^[0-9]*$/
			}
		},
		messages : {
			condVal:{ 
				required : "Input value",
				pattern: "Input proper"
			},
			limitMaxCalls:{
				pattern: "Input numeric"
			},
			limitDurationS:{
				pattern: "Input numeric"
			}
		},
		errorPlacement : function(error, element) {
			error.insertAfter(element.parent());
		}
	});
	
	
	// delete overseas
	$("#btnDeleteOverseas").click(function(){
		
		var arr = $("#selOverseas").val();
		if(arr==null){
			showMsg('Warning', 'Select a item to delete.')
		}else if(arr.length>1){
			showMsg('Warning', 'Select a item to delete.')
		}else{
			var item = arr[0].split('|');
			showConfirm("Confirm", "Do you want to delete ["+item[3]+"] ?");
			
			$("#btnConfirm").unbind('click');
			$("#btnConfirm").click(function(){
				showLoader();
				var param = {opMode: 4, policyMode: item[0], limitMaxCalls:item[1], limitDurationS:item[2], condVal:item[3]};
				$.ajax({
					url: '/takeSecCallOverseas',
				    type: "post",
				    data: param,
				    success: function(json) {
				    	processResult(json.result, null, null, null);
				    	getOverseas();
				    }
				});
				
			});
		}
	});
	
	
	// ############### OVERSEAS USER ######################################## -->
	
	// add overseasUser
	$('#frmOverseasUser #btnAddOverseasUser').click(function(){
		
		if(!$('#frmOverseasUser').valid()){
			return;
		}
		
		var condVal = getControlInput("frmOverseasUser", "condVal");
		var policyMode = getControlRadio("frmOverseasUser", "policyMode");
		
		showConfirm('Confirm', "Do you want to add?");
		$("#btnConfirm").unbind('click');
		$("#btnConfirm").click(function(){
			showLoader();
			var param = {condVal: condVal , policyMode: policyMode};
			param.opMode=2; // add 
			$.ajax({
				url: '/takeSecCallOverseasUser',
			    type: "post",
			    data: param,
			    success: function(json) {
			    	processResult(json.result, null, tableOverseasUser, null);
			    }
			});
		});
		
	});
	
	validatorOverseasUser = $('#frmOverseasUser').validate({
		onfocusout: function(element) {$(element).valid()},
		onkeyup: function(element) {$(element).valid();},
		rules : {
			condVal:{
				required : true,
			}
		},
		messages : {
			condVal:{ 
				required : "Input value",
			}
		},
		errorPlacement : function(error, element) {
			error.insertAfter(element.parent());
		}
	});
	
	// delete overseasUser
	$("#btnDeleteOverseasUser").click(function(){
		
		var arr = $("#selOverseasUser").val();
		if(arr==null){
			showMsg('Warning', 'Select a item to delete.')
		}else if(arr.length>1){
			showMsg('Warning', 'Select a item to delete.')
		}else{
			var item = arr[0].split('|');
			showConfirm("Confirm", "Do you want to delete ["+item[1]+"] ?");
			
			$("#btnConfirm").unbind('click');
			$("#btnConfirm").click(function(){
				showLoader();
				var param = {opMode: 4, policyMode: item[0], condVal:item[1]}; 
				$.ajax({
					url: '/takeSecCallOverseasUser',
				    type: "post",
				    data: param,
				    success: function(json) {
				    	processResult(json.result, null, null, null);
				    	getOverseasUser();
				    }
				});
				
			});
			
		}
	});
	
	
	// ############### CALL GAPPING ######################################## -->
	
	tableCallGapping = $('#dtCallGapping').DataTable({
		"sDom":  sDomNoControl,
		"oLanguage": oLanguage,
		"autoWidth" : true,
		"tableTools":tableTools,
		"scrollY" : "400px",
		"scrollX" : false,
		"scrollCollapse": true,
		"paging": false,
		"processing": true,
	 	"ajax": {
        	"url": "/getSecCallGapping",
        	"type": "post",
	  	},
        "columns": [
					{ "data": "condVal"},    // 값
					{ "data": "limitMaxCalls"},  // 임계치
    		    ],
    	'columnDefs': [	 
				{'targets': 0, 'className': 'text-center'},
				{'targets': 1, 'className': 'text-center', 'render': function (data, type, full, meta){ return getLimitMaxCallsDurationS_Gapping(data, full.limitDurationS) }},  
    	 ]
	});
	
	//	click row
	tableCallGapping.on( 'click', 'tr', function () {
		tableCallGapping.$('tr.selected').removeClass('selected');
		$(this).addClass('selected');
	});	
	
	
	// btnApplyCallGapping
	$("#frmCallGappingMode #btnApplyCallGapping").click(function(){
		showConfirm('Confirm', "Do you really want to apply?");
		$("#btnConfirm").unbind('click');
		$("#btnConfirm").click(function(){
	 		showLoader();
	 		applyOverview();
		});	
	});
	
	
	// btnAddCallGapping
	$("#frmCallGapping #btnAddCallGapping").click(function(){
		if(!$('#frmCallGapping').valid()){
			return;
		}
		
		var condVal = getControlInput("frmCallGapping", "condVal");
		var	limitMaxCalls = getControlInput("frmCallGapping", "limitMaxCalls");
		var	limitDurationS = getControlInput("frmCallGapping", "limitDurationS");
		
		showConfirm('Confirm', "Do you want to add?");
		$("#btnConfirm").unbind('click');
		$("#btnConfirm").click(function(){
			showLoader();
			var param = {condVal: condVal , limitMaxCalls: limitMaxCalls, limitDurationS: limitDurationS};
			param.opMode=2; // add 
			$.ajax({
				url: '/takeSecCallGapping',
			    type: "post",
			    data: param,
			    success: function(json) {
			    	processResult(json.result, null, tableCallGapping, null);
			    	refreshCallGapping();
			    }
			});
		});
	});
	
	
	validatorCallGapping = $('#frmCallGapping').validate({
		onfocusout: function(element) {$(element).valid()},
		onkeyup: function(element) {$(element).valid();},
		rules : {
			condVal:{
				required : true,
				pattern: /^[\d\.*]+$/
			},
			limitMaxCalls:{
				required : true,
				pattern: /^[0-9]*$/
			},
			limitDurationS:{
				required : true,
				pattern: /^[0-9]*$/
			}
		},
		messages : {
			condVal:{ 
				required : "Input value",
				pattern: "Input proper"
			},
			limitMaxCalls:{
				required : "Input value",
				pattern: "Input numeric"
			},
			limitDurationS:{
				required : "Input value",
				pattern: "Input numeric"
			}
		},
		errorPlacement : function(error, element) {
			error.insertAfter(element.parent());
		}
	});
	
	
	// delete CallGapping
	$("#btnDeleteCallGapping").click(function(){
		
		var data = tableCallGapping.rows('.selected').data();
		if(data.length==0){
			showMsg("Warning", "Select a row to delete!");
		}else{
			showConfirm('Confirm', "Do you want to delete?");
			$("#btnConfirm").unbind('click');
			$("#btnConfirm").click(function(){
				showLoader();
				var param = data[0];
				param.opMode=4; // remove opMode
				$.ajax({
					url: '/takeSecCallGapping',
				    type: "post",
				    data: param,
				    success: function(json) {
				    	processResult(json.result, null, tableCallGapping, null);
				    }
				});
			});
		}
	});
	
	// refresh
	$("#btnRefreshCallGapping").click(function(){
		tableCallGapping.ajax.reload(null, false);
	});
	
	
	
	
	// ############### javis widget ######################################## 
	 
	$("#btnGoGeoIp").click(function(){
		showDetail($("#widGeoIp"));
	});
	$("#btnGoUserAgent").click(function(){
		showDetail($("#widUserAgent"));
		refreshUserAgent();
	});
	$("#btnGoCallPattern").click(function(){
		showDetail($("#widCallPattern"));
	});
	$("#btnGoOverseas").click(function(){
		showDetail($("#widOverseas"));
		refreshOverseas();
	});
	$("#btnGoCallGapping").click(function(){
		showDetail($("#widCallGapping"));
		refreshCallGapping();
	});
	$("#btnGoImSignature").click(function(){
		showDetail($("#widImSignature"));
	});
	
	
} // pagefunction

$('body').append( $('<div>').load("/resources/html/common.html"));

loadScript("/resources/js/plugin/datatables/jquery.dataTables.min.js", function(){
	loadScript("/resources/scripts/common/dataTables.js", function(){
		loadScript("/resources/scripts/common/controls.js", pagefunction);
	});
});



function showDetail(obj){
	$("#widGeoIp").hide();
	$("#widUserAgent").hide();
	$("#widCallPattern").hide();
	$("#widOverseas").hide();
	$("#widCallGapping").hide();
	$("#widImSignature").hide();
	if(obj!=null)
		obj.show();
}

function getSecOverview(){
	$.post("getSecOverview", {}, function(json){
		var item = json.result;
		
		// icon
		$("#lblGeoIp").text((item.secOvGeoIpMode==0)?"OFF":"ON");
		$("#lblUserAgent").text((item.secOvUagentMode==0)?"OFF":"ON");
		$("#lblCallPattern").text((item.secOvCallPatternMode==0)?"OFF":"ON");
		$("#lblOverseasPolicy").text((item.secOvCallOverseasMode==0)?"OFF":"ON");
		$("#lblGappingPolicy").text((item.secOvCallGappingMode==0)?"OFF":"ON");
		$("#lblSignaturePolicy").text((item.secOvImSignatureMode==0)?"OFF":"ON");
		
		// 상세 바로가기 버튼
// 		$("#btnGoGeoIp").attr("disabled", (item.secOvGeoIpMode==0)?true:false);
// 		$("#btnGoUserAgent").attr("disabled", (item.secOvUagentMode==0)?true:false);
// 		$("#btnGoCallPattern").attr("disabled", (item.secOvCallPatternMode==0)?true:false);
// 		$("#btnGoOverseas").attr("disabled", (item.secOvCallOverseasMode==0)?true:false);
// 		$("#btnGoCallGapping").attr("disabled", (item.secOvCallGappingMode==0)?true:false);
// 		$("#btnGoImSignature").attr("disabled", (item.secOvImSignatureMode==0)?true:false);
		
		// policy radio
// 		setControlRadio("frmUserAgentPolicy", "secOvUagentPolicy", (item.secOvUagentPolicy==0)?0:1, false);
		setControlRadio("frmOverseasPolicy", "secOvCallOverseasPolicy", (item.secOvCallOverseasPolicy==0)?0:1, false);
		
		// check (switch)
		setControlCheck("frmGeoIp", "chkGeoIp", (item.secOvGeoIpMode==0)?0:1, false);
		setControlCheck("frmUserAgentPolicy", "chkUserAgent", (item.secOvUagentMode==0)?0:1, false);
// 		setControlCheck("frmCallPattern", "chkCallPattern", (item.secOvCallPatternMode==0)?0:1, false);
		setControlCheck("frmOverseasPolicy", "chkOverseas", (item.secOvCallOverseasMode==0)?0:1, false);
		setControlCheck("frmCallGappingMode", "chkCallGapping", (item.secOvCallGappingMode==0)?0:1, false);
		setControlCheck("frmImSignature", "chkImSignature", (item.secOvImSignatureMode==0)?0:1, false);
	});
}


//------------------------------- GEO-IP --------------------------------------------------------

function getGeoIpConfig(){
	
	$.post("getGeoIpConfig", {}, function(json){
		var item=json.result;
		
		//var geoIpOperMode = item.geoIpOperMode;
		var geoIpDbUpdateTime = item.geoIpDbUpdateTime;
		var geoIpDbAvailableTerm =  item.geoIpDbAvailableTerm;
		var geoUpdateDate = item.geoUpdateDate;
		
		// GEO-IP DB Mode
		//$("#geoIpOperMode").val(geoIpOperMode);
		
		// Update GEO-IP DB
		if(geoIpDbUpdateTime != ''){
			$("#geoIpDbUpdateTime").val(geoIpDbUpdateTime);
		}
		
		// Last Update DateTime
		$("#geoUpdateDate").text(geoUpdateDate);
		
		// Available Recent
		if(geoIpDbAvailableTerm != ''){
			$("#geoIpDbAvailableTerm").val(geoIpDbAvailableTerm);
		}
	});
	
}
function getGeoIpList(){
	$.post("getGeoIpList", {}, function(json){
		var list = json.result;
		var html ='';
		for(var i=0;i<list.length;i++){
			var item = list[i];
			var checked = (item.geoNationAction==1)?'checked':'';
			
			html += 
				'<section class="col col-3">'+
					'<label class="checkbox"  >'+
						'<input type="checkbox"  id="'+item.geoNationCode+'" '+checked+'><i></i>'+item.geoNation+
					'</label>'+
				'</section>';
		}
		$("#divGeoIpList").html(html);
	});
}








function getPolicy(val){
	if(val=='0') return "허용";
	else return "차단";
}
function getMethod(val){
	if(val==255) return "ALL";
	val|=128; // 1000 0000
	var str=''; 
	if(intToBitDigitValue(val, 0)){
		if(str!='') str+=' | ';
		str+='REGISTER';
	}
	if(intToBitDigitValue(val, 1)){
		if(str!='') str+=' | ';
	    str+='OPTION';
	}
	if(intToBitDigitValue(val, 2)){
		if(str!='') str+=' | ';
		str+='INVITE';
	}
	if(intToBitDigitValue(val, 3)){
		if(str!='') str+=' | ';
		str+='CANCEL';
	}
	if(intToBitDigitValue(val, 4)){
		if(str!='') str+=' | ';
		str+='UPDATE';
	}
	if(intToBitDigitValue(val, 5)){
		if(str!='') str+=' | ';
		str+='BYE';
	}
	if(intToBitDigitValue(val, 6)){
		if(str!='') str+=' | ';
		str+='MESSAGE';
	}
	return str;
}

function getHeader(val){
	if(val==255) return "ALL";
	val|=128; // 1000 0000
	var str='';
	if(intToBitDigitValue(val, 0)){
		if(str!='') str+=' | ';
		str+='FROM';
	}
	if(intToBitDigitValue(val, 1)){
		if(str!='') str+=' | ';
	    str+='TO';
	}
	if(intToBitDigitValue(val, 2)){
		if(str!='') str+=' | ';
		str+='CONTACT';
	}
	if(intToBitDigitValue(val, 3)){
		if(str!='') str+=' | ';
		str+='CANUSER-AGENTCEL';
	}
	if(intToBitDigitValue(val, 4)){
		if(str!='') str+=' | ';
		str+='SUBJECT';
	}
	if(intToBitDigitValue(val, 5)){
		if(str!='') str+=' | ';
		str+='CALL-ID';
	}
	return str;
}

function intToBitDigitValue(value, bitDigit) {
	// 비트번째의 거듭제곱을 구함.
	var bitVal = Math.pow(2, bitDigit);
	value = parseInt(value, 10);
	
    // 입력된 값과 거듭제곱을 AND연산후
    // 결과 값이 거듭제곱과 같으면 비트값은 1, 틀리면 0
	if (parseInt((value & bitVal), 10) == bitVal) {
		return true;
	} else {
		return false;
	}
}

function getCallPattern(){
	$.post("getSecCallPattern", {}, function(json){
		var item = json.result;
		
		if(item!=null){
// 			setControlCheck("frmCallPattern", "limitEnable", (item.limitEnable==1)?true:false, false);
			setControlInput("frmCallPattern", "limitMaxCalls", item.limitMaxCalls, false);	
			setControlInput("frmCallPattern", "limitDurationM", item.limitDurationM, false);	
			
// 			setControlCheck("frmCallPattern", "totalEnable", (item.totalEnable==1)?true:false, (item.limitEnable==1)?false:true);	
// 			setControlInput("frmCallPattern", "totalDurationM", item.totalDurationM, (item.totalEnable==1&&item.limitEnable==1)?false:true);	
// 			setControlInput("frmCallPattern", "totalDurationH", item.totalDurationH, (item.totalEnable==1&&item.limitEnable==1)?false:true);	
			
			setControlInput("frmCallPattern", "totalDurationM", item.totalDurationM, false);	 // ahnks
		
			//if(item.limitEnable==1){
				$("#frmCallPattern [name=lblClass]").removeClass("state-disabled");
// 			}else{
// 				$("#frmCallPattern [name=lblClass]").addClass("state-disabled");
// 			}
			
			if(item.totalEnable==1){
				$("#frmCallPattern [name=lblClass2]").removeClass("state-disabled");
			}else{
				$("#frmCallPattern [name=lblClass2]").addClass("state-disabled");
			}
		}
		
	});
}

function toggleLimitEnable(){

	var limitEnable = getControlCheck("frmCallPattern", "limitEnable");
	if(limitEnable){ // activate
		$("#frmCallPattern [name=lblClass]").removeClass("state-disabled");
		setControlInput("frmCallPattern", "limitMaxCalls", "", false);
		setControlInput("frmCallPattern", "limitDurationM", "", false);
		
// 		var totalEnable = getControlCheck("frmCallPattern", "totalEnable");
// 		setControlCheck("frmCallPattern", "totalEnable", totalEnable, false);
		
		toggleTotalEnable(totalEnable);
		
	}else{
		$("#frmCallPattern [name=lblClass]").addClass("state-disabled");
		setControlInput("frmCallPattern", "limitMaxCalls", "", true);
		setControlInput("frmCallPattern", "limitDurationM", "", true);
		
// 		setControlCheck("frmCallPattern", "totalEnable", false, true);
		
		toggleTotalEnable(false);
	}
}

function toggleTotalEnable(totalEnable){

	var totalDurationM = getControlInput("frmCallPattern", "totalDurationM");
// 	var totalDurationH = getControlInput("frmCallPattern", "totalDurationM");
	
	if(totalEnable){ // activate
		$("#frmCallPattern [name=lblClass2]").removeClass("state-disabled");
		setControlInput("frmCallPattern", "totalDurationM", totalDurationM, false);
// 		setControlInput("frmCallPattern", "totalDurationH", totalDurationH, false);
	}else{
		$("#frmCallPattern [name=lblClass2]").addClass("state-disabled");
		setControlInput("frmCallPattern", "totalDurationM", "", true);
// 		setControlInput("frmCallPattern", "totalDurationH", "", true);
	}
}

//-------------------------- overseas -----------------------------------------------

function getLimitMaxCallsDurationS (limitMaxCalls, limitDurationS, policyMode){
	if(policyMode == 3){ // 1: 차단, 2: 허용, 3 임계치차단
		return limitMaxCalls + " / " + limitDurationS;
	}else{
		return "";
	}
}
function getLimitMaxCallsDurationS_Gapping (limitMaxCalls, limitDurationS){
	return limitMaxCalls + " / " + limitDurationS;
}
//임계치 차단 
function toogleOverseasLimit(){
	var policyMode = getControlRadio("frmOverseas", "policyMode");
	if(policyMode==3){
		setControlInput("frmOverseas", "limitMaxCalls", "", false);
		setControlInput("frmOverseas", "limitDurationS", "", false);
		
		$("#frmOverseas [name=lblClass]").removeClass("state-disabled");
	}else{
		setControlInput("frmOverseas", "limitMaxCalls", "", true);
		setControlInput("frmOverseas", "limitDurationS", "", true);
		
		$("#frmOverseas [name=lblClass]").addClass("state-disabled");
	}
}


function applyOverview(){
		var mode=getMode();
		
// 		var secOvUagentPolicy = getControlRadio("frmUserAgentPolicy", "secOvUagentPolicy");
		var secOvCallOverseasPolicy = getControlRadio("frmOverseasPolicy", "secOvCallOverseasPolicy");
		//alert(mode.secOvCallOverseasMode);
		var param = {
				secOvGeoIpMode: mode.secOvGeoIpMode, 
				secOvUagentMode: mode.secOvUagentMode,
				secOvCallPatternMode: mode.secOvCallPatternMode,
				secOvCallOverseasMode: mode.secOvCallOverseasMode,
				secOvCallGappingMode: mode.secOvCallGappingMode,
				secOvImSignatureMode: mode.secOvImSignatureMode,
				
				secOvUagentPolicy: 1, // always Deny
				secOvCallOverseasPolicy: secOvCallOverseasPolicy
		};
		param.opMode=5; // apply 
		$.ajax({
			url: '/takeSecOverview',
		    type: "post",
		    data: param,
		    success: function(json) {
		    	processResult(json.result, null, null, null);
		    	getSecOverview();
		    }
		});

//	});​​
}

function getMode(){
	var mode={};
	mode.secOvGeoIpMode = getControlCheck("frmGeoIp", "chkGeoIp")?1:0;
	mode.secOvUagentMode = getControlCheck("frmUserAgentPolicy", "chkUserAgent")?1:0;
// 	mode.secOvCallPatternMode = getControlCheck("frmCallPattern", "chkCallPattern")?1:0;
	mode.secOvCallOverseasMode = getControlCheck("frmOverseasPolicy", "chkOverseas")?1:0;
	mode.secOvCallGappingMode = getControlCheck("frmCallGappingMode", "chkCallGapping")?1:0;
	mode.secOvImSignatureMode = getControlCheck("frmImSignature", "chkImSignature")?1:0;

	return mode;
}

function getOverseas(){
	$.post("getSecCallOverseas", {}, function(json){
		var list = json.list;
		$("#selOverseas").empty();
		for(var i=0; i<list.length; i++){
			var item = list[i];
			var val = item.policyMode + "|" + item.limitMaxCalls + "|" + item.limitDurationS + "|" + item.condVal;
			$("#selOverseas").append("<option value='"+val+"'>"+item.condVal+"</option>");
		}
	});
}


function getOverseasUser(){
	$.post("getSecCallOverseasUser", {}, function(json){
		var list = json.list;
		$("#selOverseasUser").empty();
		for(var i=0; i<list.length; i++){
			var item = list[i];
			var val = item.policyMode + "|" + item.condVal;
			$("#selOverseasUser").append("<option value='"+val+"'>"+item.condVal+"</option>");
		}
	});
}



function refreshUserAgent(){
	setControlInput("frmUserAgent", "condVal", "", false);
	
	// clear Check-All
	$("#frmUserAgent input:checkbox[id='chkMessageAll']").prop("checked", false); 
	$("#frmUserAgent input:checkbox[id='chkHeaderAll']").prop("checked", false); 
	
	$("#frmUserAgent input[name='message']:checkbox").each(function(){
		$(this).prop("checked", false);
	});
	$("#frmUserAgent input[name='header']:checkbox").each(function(){
		$(this).prop("checked", false);
	});
	
	tableUserAgent.ajax.reload(null, false);
}

function refreshCallGapping(){
	setControlInput("frmCallGapping", "condVal", "", false);
	setControlInput("frmCallGapping", "limitMaxCalls", "", false);
	setControlInput("frmCallGapping", "limitDurationS", "", false);
	
	tableCallGapping.ajax.reload(null, false);
}

function refreshOverseas(){
	
	setControlInput("frmOverseas", "condVal", "", false);
	setControlInput("frmOverseas", "limitMaxCalls", "", false);
	setControlInput("frmOverseas", "limitDurationS", "", false);
	
	tableOverseas.ajax.reload(null, false);
	tableOverseasUser.ajax.reload(null, false);
}

</script>				